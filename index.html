<!DOCTYPE html>
<html lang="lb">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>P3 – 1. Spill: D'Zäit astellen</title>
<style>
  @font-face{
    font-family:'Schoulschrëft';
    src:url('https://raw.githubusercontent.com/albrechtclaire1007/schoulschreft/main/schoulschreft_bold%5B2%5D.TTF') format('truetype');
    font-weight:bold; font-display:swap;
  }

  :root{
    --p3-blue:#75b7cb;
    --p3-blue-soft:#e5f3f6;
    --p3-red:#f1583f;
    --btn-radius:18px;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:'Schoulschrëft', Arial, sans-serif;
    background:#fffef8;
    color:#111;
    display:flex;
    flex-direction:column;
    min-height:100vh;
  }

  /* top bar */
  .topbar{
    display:flex;
    justify-content:center;
    gap:16px;
    padding:14px 12px;
    background:var(--p3-blue-soft);
    border-bottom:4px solid var(--p3-blue);
  }
  .tab-btn{
    font-family:'Schoulschrëft', Arial, sans-serif;
    background:#fff;
    border:3px solid var(--p3-blue);
    border-radius:999px;
    padding:8px 18px;
    font-size:22px;
    cursor:pointer;
  }
  .tab-btn.active{ background:#f8fcfd; }

  /* prompt */
  .prompt-wrap{ display:flex; justify-content:center; padding:18px 10px 8px; }
  #prompt{
    background:#fff;
    border:3px solid var(--p3-blue);
    border-radius:20px;
    padding:8px 16px;
    font-size:34px;
    max-width:min(90vw, 900px);
  }

  /* listen button */
  .controls{ display:flex; justify-content:center; gap:12px; padding:10px 0 0; }
  .btn{
    font-family:'Schoulschrëft', Arial, sans-serif;
    border:3px solid var(--p3-blue);
    background:#fff;
    border-radius:var(--btn-radius);
    padding:10px 20px;
    font-size:22px;
    cursor:pointer;
  }

  /* clock area */
  .stage{
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:18px 12px 28px;
  }
  #clock{
    position:relative;
    width:360px; height:360px;
    background:#fff;
    border:12px solid var(--p3-red);
    border-radius:50%;
    margin:18px auto;
    box-shadow:0 6px 18px rgba(0,0,0,.06);
  }
  .number{
    position:absolute;
    width:40px; height:40px;
    display:flex; align-items:center; justify-content:center;
    font-size:30px;
    color:#000;
    transform:translate(-50%, -50%);
    font-family:'Schoulschrëft', Arial, sans-serif;
  }
  .hand{
    position:absolute;
    left:50%; top:50%;
    transform-origin:50% 100%;
    cursor:grab;
    border-radius:6px;
    touch-action:none;
  }
  #hourHand{
    width:8px; height:110px;
    background:var(--p3-red);
    transform:translate(-50%, -100%) rotate(0deg);
  }
  #minuteHand{
    width:6px; height:150px;
    background:var(--p3-blue);
    transform:translate(-50%, -100%) rotate(0deg);
  }
  .pivot{
    position:absolute;
    left:50%; top:50%;
    width:18px; height:18px;
    background:#fff;
    border:4px solid var(--p3-red);
    border-radius:50%;
    transform:translate(-50%, -50%);
  }

  #validateBtn{ margin-top:10px; }
  #feedback{ min-height:36px; font-size:26px; margin-top:6px; }

  @media (max-width:480px){
    #clock{ width:300px; height:300px }
    #hourHand{ height:92px } #minuteHand{ height:128px }
    .number{ font-size:26px; width:34px; height:34px }
    #prompt{ font-size:28px }
  }
</style>
</head>
<body>

<div class="topbar">
  <button class="tab-btn active">1. Spill</button>
  <button class="tab-btn" onclick="alert('2. Spill kënnt geschwënn.')">2. Spill</button>
</div>

<div class="prompt-wrap"><div id="prompt">Et ass zéng Auer</div></div>

<div class="controls">
  <button class="btn" id="listenBtn">Lauschteren</button>
</div>

<div class="stage">
  <div id="clock"></div>
  <button class="btn" id="validateBtn">Validéieren</button>
  <div id="feedback"></div>
</div>

<script>
/* ----------- data (P3 times) ----------- */
const items = [
  { label:"Et ass zéng Auer", h:10, m:0,  audio:"audio/p3_zeng_auer.mp3" },
  { label:"Et ass hallwer zwielef", h:11, m:30, audio:"audio/p3_hallwer_zwielef.mp3" },
  { label:"Et ass néng Auer", h:9, m:0, audio:"audio/p3_neng_auer.mp3" },
  { label:"Et ass hallwer siwen", h:6, m:30, audio:"audio/p3_hallwer_siwen.mp3" },
  { label:"Et ass aacht Auer", h:8, m:0, audio:"audio/p3_aacht_auer.mp3" },
  { label:"Et ass hallwer dräi", h:2, m:30, audio:"audio/p3_hallwer_draei.mp3" },
  { label:"Et ass zwielef Auer", h:12, m:0, audio:"audio/p3_zwielef_auer.mp3" },
  { label:"Et ass hallwer néng", h:8, m:30, audio:"audio/p3_hallwer_neng.mp3" },
  { label:"Et ass dräi Auer", h:3, m:0, audio:"audio/p3_draei_auer.mp3" },
  { label:"Et ass hallwer aacht", h:7, m:30, audio:"audio/p3_hallwer_aacht.mp3" },
  { label:"Et ass fënnef Auer", h:5, m:0, audio:"audio/p3_fennef_auer.mp3" },
  { label:"Et ass hallwer zéng", h:9, m:30, audio:"audio/p3_hallwer_zeng.mp3" },
  { label:"Et ass sechs Auer", h:6, m:0, audio:"audio/p3_sechs_auer.mp3" },
  { label:"Et ass hallwer fënnef", h:4, m:30, audio:"audio/p3_hallwer_fennef.mp3" },
  { label:"Et ass eng Auer", h:1, m:0, audio:"audio/p3_eng_auer.mp3" }
];
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}
shuffle(items);
let idx=0;

/* -------- clock -------- */
const clock=document.getElementById('clock');
const center={x:180,y:180};
let hands;

function drawNumbers(){
  const existing=document.querySelectorAll('.number'); existing.forEach(n=>n.remove());
  const rect=clock.getBoundingClientRect();
  const radius=(rect.width/2)-28; // inward adjust
  for(let n=1;n<=12;n++){
    const ang=(n-3)*(Math.PI*2)/12;
    const x=center.x+radius*Math.cos(ang);
    const y=center.y+radius*Math.sin(ang);
    const el=document.createElement('div');
    el.className='number';
    el.style.left=x+'px'; el.style.top=y+'px';
    el.textContent=n;
    clock.appendChild(el);
  }
}
function createHands(){
  const h=document.createElement('div');h.id='hourHand';h.className='hand';
  const m=document.createElement('div');m.id='minuteHand';m.className='hand';
  const p=document.createElement('div');p.className='pivot';
  clock.appendChild(h);clock.appendChild(m);clock.appendChild(p);
  return{hour:h,min:m};
}
drawNumbers();
hands=createHands();
window.addEventListener('resize',drawNumbers);

/* -------- dragging -------- */
function angleFromPointer(e){
  const rect=clock.getBoundingClientRect();
  const cx=rect.left+rect.width/2, cy=rect.top+rect.height/2;
  const px=(e.touches?e.touches[0].clientX:e.clientX);
  const py=(e.touches?e.touches[0].clientY:e.clientY);
  let deg=Math.atan2(py-cy,px-cx)*180/Math.PI+90;
  if(deg<0)deg+=360;
  return deg;
}
function makeRotatable(el){
  let active=false;
  const start=ev=>{if(ev.target!==el)return;active=true;ev.preventDefault();}
  const move=ev=>{if(!active)return;const deg=angleFromPointer(ev);setHand(el,deg);}
  const end=()=>{active=false;}
  el.addEventListener('mousedown',start);
  window.addEventListener('mousemove',move);
  window.addEventListener('mouseup',end);
  el.addEventListener('touchstart',start,{passive:false});
  window.addEventListener('touchmove',move,{passive:false});
  window.addEventListener('touchend',end);
}
function setHand(el,deg){
  el.style.transform=`translate(-50%,-100%) rotate(${deg}deg)`;
  el.dataset.deg=deg;
}
makeRotatable(hands.hour);makeRotatable(hands.min);

/* -------- load + validate -------- */
const promptEl=document.getElementById('prompt');
const feedbackEl=document.getElementById('feedback');
const audio=new Audio();

function loadItem(i){
  const it=items[i];
  promptEl.textContent=it.label;
  feedbackEl.textContent="";
  setHand(hands.min,0); setHand(hands.hour,0);
  const mAng=it.m*6;
  const hAng=((it.h%12)*30)+it.m*0.5;
  hands.min.dataset.target=mAng;
  hands.hour.dataset.target=hAng;
  audio.src=it.audio;
}
function smallestAngleDiff(a,b){let d=Math.abs(a-b)%360;return d>180?360-d:d}
const MIN_TOL=9,HOUR_TOL=7;
function validate(){
  const mDeg=parseFloat(hands.min.dataset.deg||0);
  const hDeg=parseFloat(hands.hour.dataset.deg||0);
  const mTarget=parseFloat(hands.min.dataset.target);
  const hTarget=parseFloat(hands.hour.dataset.target);
  const okM=smallestAngleDiff(mDeg,mTarget)<=MIN_TOL;
  const okH=smallestAngleDiff(hDeg,hTarget)<=HOUR_TOL;
  if(okM&&okH){
    feedbackEl.textContent="Richteg!";
    setTimeout(()=>{idx=(idx+1)%items.length;loadItem(idx);},800);
  }else{
    feedbackEl.textContent="Nach eng Kéier!";
  }
}

/* -------- wires -------- */
document.getElementById('listenBtn').addEventListener('click',()=>audio.play());
document.getElementById('validateBtn').addEventListener('click',validate);
loadItem(idx);
</script>
</body>
</html>

